!function(t){t.IFCCrypto=function(t){this.getAlias=function(){return IFCConst.emptyString(t.alias)},this.getName=function(){return IFCConst.emptyString(t.name)},this.isPKCS11=function(){return t.type===IFCConst.IFC_CRYPTO_PKCS11},this.isCAPI=function(){return t.type===IFCConst.IFC_CRYPTO_CAPI},this.isCAPI_LINUX=function(){return t.type===IFCConst.IFC_CRYPTO_CAPI_LINUX},this.getPath=function(){return IFCConst.emptyString(t.path)},this.getNumber=function(){return IFCConst.emptyString(t.num)},this.getDescription=function(){return IFCConst.emptyString(t.description)},this.getSerialNumber=function(){return IFCConst.emptyString(t.serial_number)},this.getModel=function(){return IFCConst.emptyString(t.model)},this.getSkipPKCS11List=function(){return IFCConst.emptyString(t.skip_pkcs11_list)},this.getAlg=function(){return IFCConst.emptyString(t.alg)},this.getCryptoId=function(){return t.type===IFCConst.IFC_CRYPTO_PKCS11?t.crypto_id=t.alias+"/"+t.num:t.type!==IFCConst.IFC_CRYPTO_CAPI&&t.type!==IFCConst.IFC_CRYPTO_CAPI_LINUX||(t.crypto_id=t.alias),IFCConst.emptyString(t.crypto_id)},this.getExtendedKeyUsage=function(){for(var t=this.getAlias(),r=[{alias:"JaCarta",oid:"1.2.643.3.205.110.1"},{alias:"ruTokenECP",oid:"1.2.643.3.205.110.7"},{alias:"VIPNet",oid:"1.2.643.3.205.110.6"},{alias:"SignalCom",oid:"1.2.643.3.205.110.8"},{alias:"LISSI-CSP",oid:"1.2.643.3.205.110.9"},{alias:"CryptoPro",oid:"1.2.643.3.205.110.2"}],e=0;e<r.length;e++)if(t.indexOf(r[e].alias)>=0)return r[e].oid;return""},this.getCertificatePolicies=function(){for(var t=this.getAlias(),r=[{alias:"JaCarta",oid:IFCConst.OID_KC1+","+IFCConst.OID_KC2},{alias:"ruTokenECP",oid:IFCConst.OID_KC1+","+IFCConst.OID_KC2},{alias:"CryptoPro",oid:IFCConst.OID_KC1},{alias:"VIPNet",oid:IFCConst.OID_KC1},{alias:"SignalCom",oid:IFCConst.OID_KC1},{alias:"LISSI-CSP",oid:IFCConst.OID_KC1}],e=0;e<r.length;e++)if(t.indexOf(r[e].alias)>=0)return r[e].oid;return IFCConst.OID_KC1}},t.IFCCertificate=function(t,r){this.getSerialNumber=function(){return IFCConst.emptyString(t.cert_sn)},this.getSubjectDN=function(){return new IFCDN(IFCConst.emptyString(t.cert_subject),IFCConst.DN_SEPARATOR_PLUGIN)},this.getIssuerDN=function(){return new IFCDN(IFCConst.emptyString(t.cert_issuer),IFCConst.DN_SEPARATOR_PLUGIN)},this.getValidFrom=function(){return IFCConst.emptyString(this.checkDate(t.cert_valid_from))},this.getValidTo=function(){return IFCConst.emptyString(this.checkDate(t.cert_valid_to))},this.getSignAndDigestAlgUri=function(){var t=this.getSignAlgOid();return t===IFCConst.OID_GOSTR3410_2012_256||t===IFCConst.OID_GOSTR3410_2012_512||t===IFCConst.OID_GOSTR3410_2001?{signMethod:"http://www.w3.org/2001/04/xmldsig-more#gostr34102001-gostr3411",digestMethod:"http://www.w3.org/2001/04/xmldsig-more#gostr3411"}:{signMethod:"",digestMethod:""}},this.getSignAlg=function(){var t=this.getSignAlgOid();return t===IFCConst.OID_GOSTR3410_2001?"gost_2001":t===IFCConst.OID_GOSTR3410_2012_256?"gost_2012_256":t===IFCConst.OID_GOSTR3410_2012_512?"gost_2012_512":""},this.getSignAlgOid=function(){return IFCConst.emptyString(t.cert_sign_alg)},this.isValid=function(){return new Date<new Date(this.getValidTo())},this.getId=function(){return IFCConst.emptyString(t.id)},this.getContainerId=function(){return r.getCryptoId()+"/"+IFCConst.emptyString(t.id)},this.getCryptoId=function(){return r.getCryptoId()},this.isPKCS11=function(){return r.isPKCS11()},this.isCAPI=function(){return r.isCAPI()},this.isCAPI_LINUX=function(){return r.isCAPI_LINUX()},this.checkDate=function(t){return isNaN(new Date(t).getTime())?t.replace(/([a-z]*\s\d{1,2}\s)((?:\d{2}:?){3})\s(\d{4}\s)(.*)/i,"$1$3$2$4"):t}},t.IFCCertificateInfo=function(t){this.getSerialNumber=function(){return IFCConst.emptyString(t.cert_sn)},this.getSubjectDN=function(){return new IFCDN(IFCConst.emptyString(t.cert_subject),IFCConst.DN_SEPARATOR_PLUGIN)},this.getIssuerDN=function(){return new IFCDN(IFCConst.emptyString(t.cert_issuer),IFCConst.DN_SEPARATOR_PLUGIN)},this.getValidFrom=function(){return IFCConst.emptyString(this.checkDate(t.cert_valid_from))},this.getValidTo=function(){return IFCConst.emptyString(this.checkDate(t.cert_valid_to))},this.getSignAndDigestAlgUri=function(){var t=this.getSignAlgOid();return t===IFCConst.OID_GOSTR3410_2012_256||t===IFCConst.OID_GOSTR3410_2012_512||t===IFCConst.OID_GOSTR3410_2001?{signMethod:"http://www.w3.org/2001/04/xmldsig-more#gostr34102001-gostr3411",digestMethod:"http://www.w3.org/2001/04/xmldsig-more#gostr3411"}:{signMethod:"",digestMethod:""}},this.getSignAlg=function(){var t=this.getSignAlgOid();return t===IFCConst.OID_GOSTR3410_2001?"gost_2001":t===IFCConst.OID_GOSTR3410_2012_256?"gost_2012_256":t===IFCConst.OID_GOSTR3410_2012_512?"gost_2012_512":""},this.getSignAlgOid=function(){return IFCConst.emptyString(t.cert_sign_alg)},this.isValid=function(){return new Date<new Date(this.getValidTo())},this.getBase64=function(){return IFCConst.emptyString(t.base64)},this.getPem=function(){return IFCConst.emptyString(t.pem)},this.getVersion=function(){return IFCConst.emptyString(t.version)},this.getExtensionsString=function(){return IFCConst.emptyString(t.extensions)},this.getPrintableText=function(){return this.getPrintable("\n","\t",", ")},this.getPrintableHTML=function(){return this.getPrintable("<br />","&nbsp;&nbsp;",", ")},this.getPrintable=function(t,r,e){t||(t="\n"),r||(r="\t"),e||(e=", ");var n="Номер квалифицированного сертификата: "+this.getSerialNumber()+t+"Действие квалифицированного сертификата:"+t+r+r+"с "+this.getValidFrom()+t+r+r+"по "+this.getValidTo()+t+t+r+"Сведения о владельце квалифицированного сертификата"+t+t+"Фамилия, имя, отчество: "+this.getSubjectDN().getCommonName()+t+"Страховой номер индивидуального лицевого счета: "+this.getSubjectDN().getSNILS()+t+t+r+"Сведения об издателе квалифицированного сертификата"+t+t+"Наименование  удостоверяющего  центра: "+this.getIssuerDN().getCommonName()+t+"Место  нахождения  удостоверяющего центра: "+this.getIssuerDN().getCountryName()+e+this.getIssuerDN().getStateOrProvinceName()+e+this.getIssuerDN().getLocalityName()+e+this.getIssuerDN().getStreetAddress()+t;return this.getIssuerDN().getSurname()?n+="Доверенное лицо удостоверяющего центра: "+this.getIssuerDN().getSurname():this.getIssuerDN().getGivenName()?n+=e+this.getIssuerDN().getGivenName()+t:n+=t,n+(r+"Расширения сертификата")+t+t+this.getExtensionsString().replace(/(\r\n|\n|\r)/gm,t).replace(/^\s+/gm,r)},this.checkDate=function(t){return isNaN(new Date(t).getTime())?t.replace(/([a-z]*\s\d{1,2}\s)((?:\d{2}:?){3})\s(\d{4}\s)(.*)/i,"$1$3$2$4"):t}},t.IFCDN=function(t,r){var e=function(t){switch(t.toLowerCase()){case"commonname":case"cn":return IFCConst.OID_COMMON_NAME;case"surname":return IFCConst.OID_SURNAME;case"givenname":return IFCConst.OID_GIVEN_NAME;case"countryname":case"c":return IFCConst.OID_COUNTRY_NAME;case"stateorprovincename":return IFCConst.OID_STATE_OR_PROVINCE_NAME;case"localityname":case"l":return IFCConst.OID_LOCALITY_NAME;case"streetaddress":case"street":return IFCConst.OID_STREET_ADDRESS;case"organizationname":case"o":return IFCConst.OID_ORGANIZATION_NAME;case"organizationunitname":case"ou":return IFCConst.OID_ORGANIZATION_UNIT_NAME;case"title":return IFCConst.OID_TITLE;case"emailaddress":case"email":return IFCConst.OID_EMAIL_ADDRESS;case"ogrn":return IFCConst.OID_OGRN;case"snils":return IFCConst.OID_SNILS;case"inn":return IFCConst.OID_INN;default:return t}},n=t.split("\\,").join("[escaped_comma]").split(r);this.dnData=new Object;for(var i=0;i<n.length;i++){var _=n[i].split("=");null==_[1]&&(_[1]="");var s=_[0].trim(),C=_[1].trim().split("[escaped_comma]").join(",");this.dnData[e(s)]=C}this.getCommonName=function(){return IFCConst.emptyString(this.dnData[IFCConst.OID_COMMON_NAME])},this.getSurname=function(){return IFCConst.emptyString(this.dnData[IFCConst.OID_SURNAME])},this.getGivenName=function(){return IFCConst.emptyString(this.dnData[IFCConst.OID_GIVEN_NAME])},this.getCountryName=function(){return IFCConst.emptyString(this.dnData[IFCConst.OID_COUNTRY_NAME])},this.getStateOrProvinceName=function(){return IFCConst.emptyString(this.dnData[IFCConst.OID_STATE_OR_PROVINCE_NAME])},this.getLocalityName=function(){return IFCConst.emptyString(this.dnData[IFCConst.OID_LOCALITY_NAME])},this.getStreetAddress=function(){return IFCConst.emptyString(this.dnData[IFCConst.OID_STREET_ADDRESS])},this.getOrganizationName=function(){return IFCConst.emptyString(this.dnData[IFCConst.OID_ORGANIZATION_NAME])},this.getOrganizationUnitName=function(){return IFCConst.emptyString(this.dnData[IFCConst.OID_ORGANIZATION_UNIT_NAME])},this.getTitle=function(){return IFCConst.emptyString(this.dnData[IFCConst.OID_TITLE])},this.getEmailAddress=function(){return IFCConst.emptyString(this.dnData[IFCConst.OID_EMAIL_ADDRESS])},this.getOGRN=function(){return IFCConst.emptyString(this.dnData[IFCConst.OID_OGRN])},this.getSNILS=function(){return IFCConst.emptyString(this.dnData[IFCConst.OID_SNILS])},this.getINN=function(){return IFCConst.emptyString(this.dnData[IFCConst.OID_INN])},this.getValueByOid=function(t){return IFCConst.emptyString(this.dnData[e(t)])},this.getSubjectArray=function(){var t=new Object,r=0;for(var e in this.dnData)t["oid_"+ ++r]=e,t["oid_type_"+r]=IFCConst.getDNDataType(e),t["value_"+r]=this.dnData[e];return t.oids_count=r,t},this.getOneLine=function(){var t="";return this.getCountryName()&&(t+="c="+this.getCountryName()+", "),this.getStateOrProvinceName()&&(t+="stateorprovincename="+this.getStateOrProvinceName()+", "),this.getLocalityName()&&(t+="l="+this.getLocalityName()+", "),this.getCommonName()&&(t+="cn="+this.getCommonName()+", "),this.getSurname()&&(t+="surname="+this.getSurname()+", "),this.getGivenName()&&(t+="givenname="+this.getGivenName()+", "),this.getStreetAddress()&&(t+="street="+this.getStreetAddress()+", "),this.getOrganizationName()&&(t+="o="+this.getOrganizationName()+", "),this.getOrganizationUnitName()&&(t+="ou="+this.getOrganizationUnitName()+", "),this.getTitle()&&(t+="title="+this.getTitle()+", "),this.getEmailAddress()&&(t+="email="+this.getEmailAddress()+", "),this.getOGRN()&&(t+="ogrn="+this.getOGRN()+", "),this.getSNILS()&&(t+="snils="+this.getSNILS()+", "),this.getINN()&&(t+="inn="+this.getINN()+", "),t.substring(0,t.length-2)}},t.IFCCertificateRequest=function(t,r){this.getContainerId=function(){return t},this.getCsr=function(){return r}},t.IFCEncrypted=function(t,r,e){this.getData=function(){return t},this.getKey=function(){return r},this.getCertificate=function(){return e}},t.IFCHash=function(t){this.getBase64=function(){return t},this.getHexBinary=function(){return e(r(t))},this.getPlainData=function(){return r(t)};var r=function(t){var r,e={},n=[],i="",_=String.fromCharCode,s=[[65,91],[97,123],[48,58],[43,44],[47,48]];for(z in s)for(r=s[z][0];r<s[z][1];r++)n.push(_(r));for(r=0;r<64;r++)e[n[r]]=r;for(r=0;r<t.length;r+=72){var C,o=0,I=0,a=t.substring(r,r+72);for(C=0;C<a.length;C++)for(o=(o<<6)+e[a.charAt(C)],I+=6;I>=8;)i+=_((o>>>(I-=8))%256)}return i},e=function(t){for(var r,e=[],n="",i=0,_=t.length;i<_;++i)r=t.charCodeAt(i),e.push((r>>4).toString(16),(15&r).toString(16));for(String.prototype.concat.apply("",e),i=0;i<e.length;i++)n+=e[i];return n}},t.IFCConst={IFC_DATATYPE_DATA:1,IFC_DATATYPE_DATA_BASE64:2,IFC_DATATYPE_HASH:3,IFC_DATATYPE_HASH_BASE64:4,IFC_DATATYPE_FILENAME:5,IFC_CRYPTO_PKCS11:"pkcs11",IFC_CRYPTO_CAPI:"capi",IFC_CRYPTO_CAPI_LINUX:"capi_linux",OID_COMMON_NAME:"2.5.4.3",OID_SURNAME:"2.5.4.4",OID_GIVEN_NAME:"2.5.4.42",OID_COUNTRY_NAME:"2.5.4.6",OID_STATE_OR_PROVINCE_NAME:"2.5.4.8",OID_LOCALITY_NAME:"2.5.4.7",OID_STREET_ADDRESS:"2.5.4.9",OID_ORGANIZATION_NAME:"2.5.4.10",OID_ORGANIZATION_UNIT_NAME:"2.5.4.11",OID_TITLE:"2.5.4.12",OID_EMAIL_ADDRESS:"1.2.840.113549.1.9.1",OID_OGRN:"1.2.643.100.1",OID_SNILS:"1.2.643.100.3",OID_INN:"1.2.643.3.131.1.1",OID_KC1:"1.2.643.100.113.1",OID_KC2:"1.2.643.100.113.2",OID_KC3:"1.2.643.100.113.3",OID_GOSTR3410_2001:"1.2.643.2.2.19",OID_GOSTR3410_2012_256:"1.2.643.7.1.1.1.1",OID_GOSTR3410_2012_512:"1.2.643.7.1.1.1.2",DN_SEPARATOR_PLUGIN:"\n",DN_SEPARATOR_INPUT:",",IFC_CERT_LOAD_FROM_CONTAINER:1,IFC_CERT_LOAD_FROM_FILE:2,IFC_CERT_LOAD_FROM_STRING:3,IFC_SIGNTYPE_SIMPLE:1,IFC_SIGNTYPE_SIMPLE_REVERSE:2,IFC_SIGNTYPE_CMS_ATTACHED:3,IFC_SIGNTYPE_CMS_DETACHED:4,IFC_SIGNTYPE_CADES_BES_ATTACHED:5,IFC_SIGNTYPE_CADES_BES_DETACHED:6,IFC_HARDWARE_HASH:1,IFC_SOFTWARE_HASH:2,IFC_BASE64:1,IFC_RAW:0,IFC_SHOW_CSP_UI:1,IFC_HIDE_CSP_UI:0,IFC_X509_INFO_CERT_BASE64ENCODED:1,IFC_X509_INFO_CERT_DER:2,IFC_X509_INFO_CERT_VERSION:3,IFC_X509_INFO_CERT_SERIALNUMBER:4,IFC_X509_INFO_CERT_SUBJECT:5,IFC_X509_INFO_CERT_ISSUER:6,IFC_X509_INFO_CERT_VALIDFROM:7,IFC_X509_INFO_CERT_VALIDTO:8,IFC_X509_INFO_CERT_X509EXTENSIONS:9,IFC_X509_INFO_CERT_PEM:10,IFC_X509_INFO_CERT_ALG:11,IFC_CERT_UNKNOWN:0,IFC_CERT_DER:1,IFC_CERT_BASE64:2,IFC_CERT_PEM:3,IFC_REQ_DER:0,IFC_REQ_PEM:1,IFC_REQ_BASE64ENCODED:2,P11_PIN_TYPE_USER:0,P11_PIN_TYPE_ADMIN:1,IFC_PRINTABLE_STRING:19,IFC_IA5STRING:22,IFC_NUMERICSTRING:18,IFC_UTF8STRING:12,IFC_OCTET_STRING:4,IFC_BMPSTRING:30,APDU_FORMAT_RAW:0,APDU_FORMAT_TEXT:1,SHOW_SAFETOUCH:0,getDNDataType:function(t){var r;switch(t){case this.OID_COUNTRY_NAME:r=this.IFC_PRINTABLE_STRING;break;case this.OID_SNILS:case this.OID_OGRN:case this.OID_INN:r=this.IFC_NUMERICSTRING;break;case this.OID_EMAIL_ADDRESS:r=this.IFC_IA5STRING;break;default:r=IFCConst.IFC_UTF8STRING}return r},emptyString:function(t){return null==t?"":t}},t.IFCError={IFC_GENERAL_ERROR:-1,IFC_OK:0,IFC_ERROR_UNKNOWN:1,IFC_ERROR_CONFIG:2,IFC_ERROR_RECORD_MAX:3,IFC_ERROR_CONFIG_EMPTY:4,IFC_BAD_PARAMS:5,IFC_ERROR_MALLOC:6,IFC_ALIAS_NOT_FOUND:7,IFC_ERROR_STORE:8,IFC_CERT_NOT_FOUND:9,IFC_CONTAINER_NOT_FOUND:10,IFC_UNSUPPORTED_FORMAT:11,IFC_KEY_NOT_FOUND:12,IFC_BAD_IN_TYPE:13,IFC_BAD_SIGN_TYPE:14,IFC_BAD_HASH_CONTEXT:15,IFC_BAD_TYPE_PIN:16,IFC_NOT_SUPPORTED:17,IFC_SLOT_NOT_INIT:18,IFC_ERROR_VERIFY:19,IFC_ERROR_BASE64:20,IFC_SC_ERROR:21,IFC_ENGINE_ERROR:22,IFC_P11_ERROR:23,IFC_P11_NO_TOKENS_FOUND:25,IFC_PARSE_XML_ERROR:26,IFC_XPATH_ERROR:27,IFC_CANON_XML_ERROR:28,IFC_P11_LOGIN_ERROR:160,IFC_UNICODE_ERROR:161,IFC_ENCODINGS_ERROR:162,IFC_INIT_ERROR:163,IFC_CRYPTO_NOT_FOUND:164,IFC_PLUGIN_UNDEFINED_ERROR:256,IFC_P11_INVALID_PIN_ERROR:257,getErrorDescription:function(t){switch(t){case IFCError.IFC_GENERAL_ERROR:return"Общая ошибка";case IFCError.IFC_OK:return"Операция завершена успешно";case IFCError.IFC_ERROR_UNKNOWN:return"Ошибка не определена";case IFCError.IFC_ERROR_CONFIG:return"Ошибка конфигурации";case IFCError.IFC_ERROR_RECORD_MAX:return"Достигнуто максимальное количество записей конфигурации";case IFCError.IFC_ERROR_CONFIG_EMPTY:return"Конфигурация не опеределена";case IFCError.IFC_BAD_PARAMS:return"Параметры заданы неверно";case IFCError.IFC_ERROR_MALLOC:return"Ошибка выделения памяти";case IFCError.IFC_ALIAS_NOT_FOUND:return"Указанный поставщик криптографии не найден";case IFCError.IFC_ERROR_STORE:return"Ошибка работы с хранилищем";case IFCError.IFC_CERT_NOT_FOUND:return"Сертификат не найден";case IFCError.IFC_CONTAINER_NOT_FOUND:return"Ключевой контейнер не найден";case IFCError.IFC_UNSUPPORTED_FORMAT:return"Формат не поддерживается";case IFCError.IFC_KEY_NOT_FOUND:return"Ключ не найден";case IFCError.IFC_BAD_IN_TYPE:return"Тип входных данных задан неверно";case IFCError.IFC_BAD_SIGN_TYPE:return"Тип электронной подписи задан неверно";case IFCError.IFC_BAD_HASH_CONTEXT:return"Контекст хеширования не найден";case IFCError.IFC_BAD_TYPE_PIN:return"Тип пин-кода задан неверно";case IFCError.IFC_NOT_SUPPORTED:return"Операция не поддерживается";case IFCError.IFC_SLOT_NOT_INIT:return"Слот не инициализирован";case IFCError.IFC_ERROR_VERIFY:return"Ошибка проверки подписи";case IFCError.IFC_ERROR_BASE64:return"Ошибка кодировки BASE64";case IFCError.IFC_SC_ERROR:return"Ошибка подсистемы смарт-карт";case IFCError.IFC_ENGINE_ERROR:return"Ошибка работы с библиотеки интерфейса";case IFCError.IFC_P11_ERROR:return"Ошибка работы с библиотекой PKCS#11";case IFCError.IFC_P11_NO_TOKENS_FOUND:return"Смарт-карта не найдена";case IFCError.IFC_PARSE_XML_ERROR:return"Ошибка парсинга XML";case IFCError.IFC_XPATH_ERROR:return"Ошибка выполнения XPath";case IFCError.IFC_CANON_XML_ERROR:return"Ошибка канонизации XML";case IFCError.IFC_P11_LOGIN_ERROR:return"Неверный пин-код";case IFCError.IFC_UNICODE_ERROR:return"Ошибка работы с UNICODE";case IFCError.IFC_ENCODINGS_ERROR:return"Ошибка кодировки";case IFCError.IFC_INIT_ERROR:return"Ошибка инициализации плагина";case IFCError.IFC_CRYPTO_NOT_FOUND:return"СКЗИ не найдено";case IFCError.IFC_PLUGIN_UNDEFINED_ERROR:return"Ошибка инициализации объекта плагина";case IFCError.IFC_P11_INVALID_PIN_ERROR:return"Пин-код не соответствует требованиям";default:return"Неизвестная ошибка"}}},"function"!=typeof String.prototype.trim&&(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")})}(window),function(t){t.IFCPlugin=function(r,e,n){var i="",_=null;function s(t){if(document.createEvent){var r=document.createEvent("Event");r.initEvent(t,!0,!0),document.dispatchEvent(r)}else document.documentElement[t]++}function C(){var t=navigator.userAgent;if(-1!==t.search("Safari")&&-1!==t.search("Version")){var r=t.indexOf("Version")+8,e=t.substr(r);if(e){var n=r+e.indexOf(".");if((e?parseInt(t.substring(r,n),10):0)>=12)return!0}}return!1}function o(){for(var t=navigator.userAgent,r=["Firefox","Chrome","Opera","Edge","YaBrowser","Safari"],e=0;e<r.length;e++){if(-1!==t.search(r[e])&&"Firefox"===r[e]){var n=t.indexOf(r[e])+8,i=t.substr(n);if(i){var _=n+i.indexOf(".");if((i?parseInt(t.substring(n,_),10):0)>=50)return!0}break}if(-1!==t.search(r[e])&&"Safari"===r[e]&&-1!==t.search("Version")){var s=t.indexOf("Version")+8,C=t.substr(s);if(C){var o=s+C.indexOf(".");if((C?parseInt(t.substring(s,o),10):0)>=12)return!0}break}if(-1!==t.search(r[e]))return!0}return!1}function I(t,r){_.send({func_name:"get_list_info",params:{cryptoType:t}},(function(e){if(IFCError.IFC_OK===e.error_code){for(var n=[],i=0;i<e.ifc_list.length;i++)e.ifc_list[i].type!==t&&null!=t||n.push(new IFCCrypto(e.ifc_list[i]));r({error_code:IFCError.IFC_OK,ifc_list:n})}else r(e)}))}function a(t){return I(null,t)}function c(t,r){a((function(e){if(IFCError.IFC_OK===e.error_code){for(var n=0;n<e.ifc_list.length;n++)if(t===e.ifc_list[n].getCryptoId())return void r({error_code:IFCError.IFC_OK,crypto:e.ifc_list[n]});r({error_code:IFCError.IFC_CRYPTO_NOT_FOUND,crypto:crypto})}else r(e)}))}function u(t){if(!t)return"";for(var r=["CryptoPro","VIPNet","SignalCom","LISSI-CSP"],e=0;e<r.length;e++)if(t.indexOf(r[e])>=0)return t.substring(0,t.indexOf("/"));return t.substring(0,t.lastIndexOf("/"))}function F(t,r,e,n,i,s,C){c(u(t),(function(o){IFCError.IFC_OK===o.error_code?(void 0===C&&(C=IFCConst.IFC_SHOW_CSP_UI),_.send({func_name:"sign",params:{containerId:t,userPin:r||"",inDataType:n,data:e,hashType:IFCConst.IFC_HARDWARE_HASH,signType:i,cspUI:C,outDataType:IFCConst.IFC_BASE64}},s)):s(o)}))}function E(t,r,e,n,i,s,C){s?S(s,(function(s){if(IFCError.IFC_OK===s.error_code){var o=s.x509Handle;_.send({func_name:"verify",params:{containerId:t,inDataType:i,data:n,signType:e,sign:r,x509Handle:o}},(function(t){var r,e=t.error_code;IFCError.IFC_OK===t.error_code&&(r=t.verify_result),h(o,(function(t){IFCError.IFC_OK===t.error_code?C({error_code:e,verify_result:r}):C(t)}))}))}else C(s)})):_.send({func_name:"verify",params:{containerId:t,inDataType:i,data:n,signType:e,sign:r,x509Handle:0}},C)}function f(t,r,e,n,i,s,C,o){c(u(t),(function(I){IFCError.IFC_OK===I.error_code?(void 0===o&&(o=1),_.send({func_name:"sign_xml",params:{containerId:t,userPin:r||"",wsu_id:e,inDataType:i,data:n,cspUI:o,outDataType:s}},C)):C(I)}))}function A(t,r,e,n,i){_.send({func_name:"verify_xml",params:{containerId:t,wsu_id:r,inDataType:n,sign:e}},(function(t){IFCError.IFC_OK===t.error_code?i({error_code:t.error_code,verify_result:t.verify_result}):i(t)}))}function g(t,r,e,n){_.send({func_name:"hash",params:{containerId:t,inDataType:r,data:e,outDataType:IFCConst.IFC_BASE64}},(function(t){IFCError.IFC_OK===t.error_code?n({error_code:IFCError.IFC_OK,hash:new IFCHash(t.hashValue)}):n(t)}))}function D(t,r){a((function(e){if(IFCError.IFC_OK===e.error_code){for(var n=e.ifc_list,i=[],s=0;s<n.length;s++)i.push(n[s].getCryptoId());_.send({func_name:"get_list_certs_by_cryptoid_array",params:{cryptoID_array:i,show_progress:r}},(function(r){if(IFCError.IFC_OK===r.error_code)if(r.intermediate)t(r);else{for(var e=[],i=0;i<r.result_array.length;i++){for(var _=!1,s=0;s<n.length;s++)if(n[s].getCryptoId()===r.result_array[i].crypto_id){_=n[s];break}if(!1!==_)for(var C=0;C<r.result_array[i].cert_list.length;C++)e.push(new IFCCertificate(r.result_array[i].cert_list[C],_))}t({error_code:IFCError.IFC_OK,certs_list:e})}else t(r)}))}else t(e)}))}function d(t,r,e,n,i){c(u(t),(function(s){IFCError.IFC_OK===s.error_code?r&&r.length>0||!s.crypto.isPKCS11()?function(t,r,e,n,i,s,C){_.send({func_name:"key_gen",params:{containerId:t,userPin:r}},(function(t){if(IFCError.IFC_OK===t.error_code){var o=new IFCDN(e,IFCConst.DN_SEPARATOR_INPUT).getSubjectArray(),I=("clientAuth,emailProtection,1.2.643.2.2.34.6,"+n).split(","),a=i.split(","),c=t.real_id;_.send({func_name:"req_gen",params:{containerId:c,userPin:r,subject:o,extendedKeyUsage:I,certificatePolicies:a,signInstrument:"",req_format:IFCConst.IFC_REQ_BASE64ENCODED,csrExtensions:s}},(function(t){IFCError.IFC_OK===t.error_code?C({error_code:IFCError.IFC_OK,real_id:c,req_base64_length:t.req_base64_length,req_base64:t.req_base64,req:new IFCCertificateRequest(c,t.req_base64)}):C(t)}))}else C(t)}))}(t,r,e,s.crypto.getExtendedKeyUsage(),s.crypto.getCertificatePolicies(),n,i):i({error_code:IFCError.IFC_P11_INVALID_PIN_ERROR}):i(s)}))}function O(t){_.send({func_name:"get_guid",params:{prefix:i}},t)}function N(t,r,e,n,i){O((function(_){if(IFCError.IFC_OK===_.error_code)return d(t+"/"+_.guid,r,e,n,i);i(_)}))}function T(t,r,e){c(u(t),(function(n){IFCError.IFC_OK===n.error_code?r&&r.length>0||!n.crypto.isPKCS11()?_.send({func_name:"key_delete",params:{containerId:t,userPin:r}},e):e({error_code:IFCError.IFC_P11_INVALID_PIN_ERROR}):e(n)}))}function S(t,r){_.send({func_name:"load_x509_from_data",params:{cert:t,cert_data_type:IFCConst.IFC_CERT_UNKNOWN}},r)}function h(t,r){_.send({func_name:"free_x509",params:{x509Handle:t}},r)}function R(t,r,e,n){e&&e.length>0?_.send({func_name:"p11_key_rename",params:{containerId:t,newContainerId:r,userPin:e}},n):n({error_code:IFCError.IFC_P11_INVALID_PIN_ERROR})}this.status=null,this.safariExtensionScheme="safariExtension://",this.listenPluginEvent=function(t,r){document.addEventListener?document.addEventListener(t,r,!1):document.documentElement.attachEvent("onpropertychange",(function(e){e.propertyName===t&&r()}))},_=o()?new function(){var r=t,e=!1,n=!1;function i(t){if(t.source===r)try{var i=JSON.parse(t.data);i.type&&"FROM_IFC_EXT"===i.type?function(t){if(t.intermediate)e(t);else if(e){var r=e;e=!1,r(t)}}(i.msg_data):i.type&&"IFC_EXT_DISCONNECT"===i.type&&function(){if(e){var t=e;e=!1,t({error_code:IFCError.IFC_PLUGIN_UNDEFINED_ERROR})}n=!1}()}catch(_){}}this.send=function(t,_){if(e)_({error_code:IFCError.IFC_GENERAL_ERROR});else{var s=function(){if(n)return IFCError.IFC_OK;try{r.addEventListener("message",i,!1)}catch(t){return IFCError.IFC_PLUGIN_UNDEFINED_ERROR}return n=!0,IFCError.IFC_OK}();s===IFCError.IFC_OK?function(t,n){e=n;try{r.postMessage(JSON.stringify({type:"TO_IFC_EXT",msg_data:t}),"*")}catch(i){e=!1,n({error_code:IFCError.IFC_PLUGIN_UNDEFINED_ERROR})}}(t,_):_({error_code:s})}}}:new function(t){t=t,this.send=function(r,e){try{t.post_message(JSON.stringify(r),(function(t,r){e(JSON.parse(r))}))}catch(n){e({error_code:IFCError.IFC_PLUGIN_UNDEFINED_ERROR})}}}(r),this.init=function(t){var r=this;this.status={isNativeMessaging:o(),isNewSafari:C(),extensionIsInstalled:null,pluginIsRunning:null},this.status.isNativeMessaging?setTimeout((function(){document.getElementById("ifcplugin-extension-is-installed")?(r.status.extensionIsInstalled=!0,r.status.pluginIsRunning=!!document.getElementById("ifc-plugin-is-installed")):r.status.extensionIsInstalled=!1,s("updatePluginStatus")}),t?this.status.isNewSafari?5e3:500:4):(this.status.pluginIsRunning=!1,this.getPluginVersion((function(t){IFCError.IFC_OK===t.error_code&&(r.status.pluginIsRunning=!0)})),setTimeout((function(){s("updatePluginStatus")}),1e3)),setTimeout(r.init.bind(r),5e3)},this.getLibVersion=function(t){return"2.2.1"},this.create=function(t,r,e){_.send({func_name:"create",params:{file_config:t,config_string:r,log_file_location:"",plugin_log_level:""}},e)},this.getPluginVersion=function(t){_.send({func_name:"version"},t)},this.getCryptoList=function(t){return a(t)},this.getPKCS11CryptoList=function(t){return I(IFCConst.IFC_CRYPTO_PKCS11,t)},this.getCAPICryptoList=function(t){return I(IFCConst.IFC_CRYPTO_CAPI,t)},this.getCAPILINUXCryptoList=function(t){return I(IFCConst.IFC_CRYPTO_CAPI_LINUX,t)},this.getCryptoById=function(t,r){return c(t,r)},this.getCertificateList=function(t){return D(t,0)},this.getCertificateListWithProgress=function(t){return D(t,1)},this.getCertificateListByCryptoId=function(t,r){return function(t,r){c(t,(function(t){if(IFCError.IFC_OK===t.error_code){var e=t.crypto;_.send({func_name:"get_list_certs",params:{cryptoID:e.getCryptoId()}},(function(t){if(IFCError.IFC_OK===t.error_code){certsArray=[];for(var n=0;n<t.cert_list.length;n++)certsArray.push(new IFCCertificate(t.cert_list[n],e));r({error_code:IFCError.IFC_OK,certs_list:certsArray})}else r(t)}))}else r(t)}))}(t,r)},this.getKeyListByCryptoId=function(t,r,e){return function(t,r,e){c(t,(function(t){if(IFCError.IFC_OK===t.error_code){var n=t.crypto;r&&r.length>0||!n.isPKCS11()||e({error_code:IFCError.IFC_P11_INVALID_PIN_ERROR}),_.send({func_name:"get_list_keys",params:{cryptoID:n.getCryptoId(),userPin:r}},(function(t){if(IFCError.IFC_OK===t.error_code){keysArray=[];for(var r=0;r<t.keys_list.length;r++)keysArray.push(new IFCCertificate(t.keys_list[r],n));e({error_code:IFCError.IFC_OK,keys_list:keysArray})}else e(t)}))}else e(t)}))}(t,r,e)},this.getCryptoIdByContainerId=function(t){return u(t)},this.signDataXml=function(t,r,e,n,i,_,s){return f(t,r,e,n,IFCConst.IFC_DATATYPE_DATA,i,_,s)},n&&(this.verifyDataXml=function(t,r,e,n){return A(t,r,e,IFCConst.IFC_DATATYPE_DATA,n)}),this.signDataBase64Xml=function(t,r,e,n,i,_,s){return f(t,r,e,n,IFCConst.IFC_DATATYPE_DATA_BASE64,i,_,s)},n&&(this.verifyDataBase64Xml=function(t,r,e,n){return A(t,r,e,IFCConst.IFC_DATATYPE_DATA_BASE64,n)}),this.signDataCmsAttached=function(t,r,e,n,i){return F(t,r,e,IFCConst.IFC_DATATYPE_DATA,IFCConst.IFC_SIGNTYPE_CMS_ATTACHED,n,i)},n&&(this.verifyDataCmsAttached=function(t,r,e){return E(t,r,IFCConst.IFC_SIGNTYPE_CMS_ATTACHED,"",IFCConst.IFC_DATATYPE_DATA,"",e)}),this.signDataCmsDetached=function(t,r,e,n,i){return F(t,r,e,IFCConst.IFC_DATATYPE_DATA,IFCConst.IFC_SIGNTYPE_CMS_DETACHED,n,i)},n&&(this.verifyDataCmsDetached=function(t,r,e,n){return E(t,r,IFCConst.IFC_SIGNTYPE_CMS_DETACHED,e,IFCConst.IFC_DATATYPE_DATA,"",n)}),this.signDataCadesBesAttached=function(t,r,e,n,i){return F(t,r,e,IFCConst.IFC_DATATYPE_DATA,IFCConst.IFC_SIGNTYPE_CADES_BES_ATTACHED,n,i)},n&&(this.verifyDataCadesBesAttached=function(t,r,e){return E(t,r,IFCConst.IFC_SIGNTYPE_CADES_BES_ATTACHED,"",IFCConst.IFC_DATATYPE_DATA,"",e)}),this.signDataCadesBesDetached=function(t,r,e,n,i){return F(t,r,e,IFCConst.IFC_DATATYPE_DATA,IFCConst.IFC_SIGNTYPE_CADES_BES_DETACHED,n,i)},n&&(this.verifyDataCadesBesDetached=function(t,r,e,n){return E(t,r,IFCConst.IFC_SIGNTYPE_CADES_BES_DETACHED,e,IFCConst.IFC_DATATYPE_DATA,"",n)}),this.signDataBase64CmsAttached=function(t,r,e,n,i){return F(t,r,e,IFCConst.IFC_DATATYPE_DATA_BASE64,IFCConst.IFC_SIGNTYPE_CMS_ATTACHED,n,i)},n&&(this.verifyDataBase64CmsAttached=function(t,r,e){return E(t,r,IFCConst.IFC_SIGNTYPE_CMS_ATTACHED,"",IFCConst.IFC_DATATYPE_DATA_BASE64,"",e)}),this.signDataBase64CmsDetached=function(t,r,e,n,i){return F(t,r,e,IFCConst.IFC_DATATYPE_DATA_BASE64,IFCConst.IFC_SIGNTYPE_CMS_DETACHED,n,i)},n&&(this.verifyDataBase64CmsDetached=function(t,r,e,n){return E(t,r,IFCConst.IFC_SIGNTYPE_CMS_DETACHED,e,IFCConst.IFC_DATATYPE_DATA_BASE64,"",n)}),this.signDataBase64CadesBesAttached=function(t,r,e,n,i){return F(t,r,e,IFCConst.IFC_DATATYPE_DATA_BASE64,IFCConst.IFC_SIGNTYPE_CADES_BES_ATTACHED,n,i)},n&&(this.verifyDataBase64CadesBesAttached=function(t,r,e){return E(t,r,IFCConst.IFC_SIGNTYPE_CADES_BES_ATTACHED,"",IFCConst.IFC_DATATYPE_DATA_BASE64,"",e)}),this.signDataBase64CadesBesDetached=function(t,r,e,n,i){return F(t,r,e,IFCConst.IFC_DATATYPE_DATA_BASE64,IFCConst.IFC_SIGNTYPE_CADES_BES_DETACHED,n,i)},n&&(this.verifyDataBase64CadesBesDetached=function(t,r,e,n){return E(t,r,IFCConst.IFC_SIGNTYPE_CADES_BES_DETACHED,e,IFCConst.IFC_DATATYPE_DATA_BASE64,"",n)}),this.signDataHash64CmsDetached=function(t,r,e,n,i){return F(t,r,e,IFCConst.IFC_DATATYPE_HASH_BASE64,IFCConst.IFC_SIGNTYPE_CMS_DETACHED,n,i)},n&&(this.verifyDataHash64CmsDetached=function(t,r,e,n){return E(t,r,IFCConst.IFC_SIGNTYPE_CMS_DETACHED,e,IFCConst.IFC_DATATYPE_HASH_BASE64,"",n)}),this.signDataHash64CadesBesDetached=function(t,r,e,n,i){return F(t,r,e,IFCConst.IFC_DATATYPE_HASH_BASE64,IFCConst.IFC_SIGNTYPE_CADES_BES_DETACHED,n,i)},n&&(this.verifyDataHash64CadesBesDetached=function(t,r,e,n){return E(t,r,IFCConst.IFC_SIGNTYPE_CADES_BES_DETACHED,e,IFCConst.IFC_DATATYPE_HASH_BASE64,"",n)}),this.signDataSimple=function(t,r,e,n,i){return F(t,r,e,IFCConst.IFC_DATATYPE_DATA,IFCConst.IFC_SIGNTYPE_SIMPLE,n,i)},n&&(this.verifyDataSimple=function(t,r,e,n,i){return E(t,r,IFCConst.IFC_SIGNTYPE_SIMPLE,e,IFCConst.IFC_DATATYPE_DATA,n,i)}),this.signHashSimple=function(t,r,e,n,i){return F(t,r,e,IFCConst.IFC_DATATYPE_HASH_BASE64,IFCConst.IFC_SIGNTYPE_SIMPLE,n,i)},n&&(this.verifyHashSimple=function(t,r,e,n,i){return E(t,r,IFCConst.IFC_SIGNTYPE_SIMPLE,e,IFCConst.IFC_DATATYPE_HASH_BASE64,n,i)}),this.signDataSimpleReversed=function(t,r,e,n,i){return F(t,r,e,IFCConst.IFC_DATATYPE_DATA,IFCConst.IFC_SIGNTYPE_SIMPLE_REVERSE,n,i)},n&&(this.verifyDataSimpleReversed=function(t,r,e,n,i){return E(t,r,IFCConst.IFC_SIGNTYPE_SIMPLE_REVERSE,e,IFCConst.IFC_DATATYPE_DATA,n,i)}),this.signDataBase64Simple=function(t,r,e,n,i){return F(t,r,e,IFCConst.IFC_DATATYPE_DATA_BASE64,IFCConst.IFC_SIGNTYPE_SIMPLE,n,i)},n&&(this.verifyDataBase64Simple=function(t,r,e,n,i){return E(t,r,IFCConst.IFC_SIGNTYPE_SIMPLE,e,IFCConst.IFC_DATATYPE_DATA_BASE64,n,i)}),this.generateKeyPairAndCsrForContainerId=function(t,r,e,n){return function(t,r,e,n){return d(t,r,e,"",n)}(t,r,e,n)},this.generateKeyPairAndCsrForContainerIdV2=function(t,r,e,n,i){return d(t,r,e,n,i)},this.generateKeyPairAndCsr=function(t,r,e,n){return function(t,r,e,n){return N(t,r,e,"",n)}(t,r,e,n)},this.generateKeyPairAndCsrV2=function(t,r,e,n,i){return N(t,r,e,n,i)},n&&(this.makeSelfSignedCert=function(t,r,e,n){return function(t,r,e,n){c(u(t),(function(i){IFCError.IFC_OK===i.error_code?r&&r.length>0||!i.crypto.isPKCS11()?_.send({func_name:"make_cert",params:{containerId:t,userPin:r,request:e}},(function(t){n(t)})):n({error_code:IFCError.IFC_P11_INVALID_PIN_ERROR}):n(i)}))}(t,r,e,n)}),this.putCertificate=function(t,r,e,n){return function(t,r,e,n){c(u(t),(function(i){IFCError.IFC_OK===i.error_code?r&&r.length>0||!i.crypto.isPKCS11()?S(e,(function(e){if(IFCError.IFC_OK===e.error_code){var i=e.x509Handle;_.send({func_name:"set_x509",params:{containerId:t,userPin:r,x509Handle:i}},(function(t){IFCError.IFC_OK===t.error_code?h(i,(function(t){n(t)})):n(t)}))}else n(e)})):n({error_code:IFCError.IFC_P11_INVALID_PIN_ERROR}):n(i)}))}(t,r,e,n)},this.deleteContainer=function(t,r,e){return T(t,r,e)},this.getGuid=function(t){return O(t)},this.setGuidPrefix=function(t){i=t},this.getGuidPrefix=function(){return i},this.getCertificate=function(t,r){return function(t,r){!function(t,r){_.send({func_name:"load_x509_from_container",params:{containerId:t}},r)}(t,(function(t){if(IFCError.IFC_OK===t.error_code){var e=t.x509Handle;_.send({func_name:"get_x509_info",params:{x509Handle:e}},(function(t){if(IFCError.IFC_OK===t.error_code){var n=new IFCCertificateInfo(t.cert_info);h(e,(function(t){r({error_code:t.error_code,cert:n})}))}else r(t)}))}else r(t)}))}(t,r)},this.getCertificateFromString=function(t,r){return function(t,r){S(t,(function(t){if(IFCError.IFC_OK===t.error_code){var e=t.x509Handle;!function(t,r){_.send({func_name:"get_x509_info",params:{x509Handle:t}},(function(t){if(IFCError.IFC_OK===t.error_code){var e=new IFCCertificateInfo(t.cert_info);r({error_code:t.error_code,cert:e})}else r(t)}))}(e,(function(t){if(IFCError.IFC_OK===t.error_code){var n=t.cert;h(e,(function(t){r({error_code:t.error_code,cert:n})}))}else r(t)}))}else r(t)}))}(t,r)},this.getHash=function(t,r,e){return g(t,IFCConst.IFC_DATATYPE_DATA,r,e)},this.getHashFromBase64=function(t,r,e){return g(t,IFCConst.IFC_DATATYPE_DATA_BASE64,r,e)},this.encrypt=function(t,r,e,n,i){return function(t,r,e,n,i){r&&r.length>0?S(e,(function(e){IFCError.IFC_OK===e.error_code?(peer_x509Handle=e.x509Handle,_.send({func_name:"encrypt",params:{containerId:t,userPin:r,peerX509Handle:peer_x509Handle,data:n}},(function(t){var r,e=t.error_code;IFCError.IFC_OK===t.error_code&&(r=new IFCEncrypted(t.enc_data_base64,t.enc_key_base64,t.cert_base64)),h(peer_x509Handle,(function(t){IFCError.IFC_OK===t.error_code?IFCError.IFC_OK===e?i({error_code:e,encrypted:r}):i({error_code:e}):i(t)}))}))):i(e)})):i({error_code:IFCError.IFC_P11_INVALID_PIN_ERROR})}(t,r,e,n,i)},this.decrypt=function(t,r,e,n,i,s){return function(t,r,e,n,i,s){r&&r.length>0?S(e,(function(e){IFCError.IFC_OK===e.error_code?(peer_x509Handle=e.x509Handle,_.send({func_name:"decrypt",params:{containerId:t,userPin:r,peerX509Handle:peer_x509Handle,encryptedData:n,encryptedKey:i}},(function(t){var r,e=t.error_code;IFCError.IFC_OK===t.error_code&&(r=t.decrypted),h(peer_x509Handle,(function(t){IFCError.IFC_OK===t.error_code?IFCError.IFC_OK===e?s({error_code:e,decrypted:r}):s({error_code:e}):s(t)}))}))):s(e)})):s({error_code:IFCError.IFC_P11_INVALID_PIN_ERROR})}(t,r,e,n,i,s)},this.pkcs11Init=function(t,r,e,n,i){return function(t,r,e,n,i){e&&e.length>0&&n&&n.length>0?_.send({func_name:"p11_init",params:{cryptoID:t,label:r,userPin:e,adminPin:n}},i):i({error_code:IFCError.IFC_P11_INVALID_PIN_ERROR})}(t,r,e,n,i)},this.pkcs11ChangeUserPin=function(t,r,e,n){return function(t,r,e,n){r&&r.length>0&&e&&e.length>0?_.send({func_name:"p11_pin_change",params:{cryptoID:t,pinType:IFCConst.P11_PIN_TYPE_USER,currentPin:r,newPin:e}},n):n({error_code:IFCError.IFC_P11_INVALID_PIN_ERROR})}(t,r,e,n)},this.pkcs11UnlockUserPin=function(t,r,e){return function(t,r,e){r&&r.length>0?_.send({func_name:"p11_pin_unlock",params:{cryptoID:t,adminPin:r}},e):e({error_code:IFCError.IFC_P11_INVALID_PIN_ERROR})}(t,r,e)},this.pkcs11ChangeAdminPin=function(t,r,e,n){return function(t,r,e,n){r&&r.length>0&&e&&e.length>0?_.send({func_name:"p11_pin_change",params:{cryptoID:t,pinType:IFCConst.P11_PIN_TYPE_ADMIN,currentPin:r,newPin:e}},n):n({error_code:IFCError.IFC_P11_INVALID_PIN_ERROR})}(t,r,e,n)},this.pkcs11RenameContainer=function(t,r,e,n){return R(t,r,e,n)},this.pkcs11MoveContainer=function(t,r,e,n){return function(t,r,e,n){e&&e.length>0?c(u(t),(function(i){IFCError.IFC_OK===i.error_code?null!=i.crypto&&i.crypto.isPKCS11()?T(u(t)+"/"+r,e,(function(i){IFCError.IFC_OK!==i.error_code&&IFCError.IFC_CONTAINER_NOT_FOUND!==i.error_code||R(t,r,e,n)})):n({error_code:IFCError.IFC_BAD_PARAMS}):n(i)})):n({error_code:IFCError.IFC_P11_INVALID_PIN_ERROR})}(t,r,e,n)},this.sendAPDU=function(t,r,e){return function(t,r,e){_.send({func_name:"send_apdu",params:{readerName:t,apdu_string:r}},e)}(t,r,e)}}}(window);